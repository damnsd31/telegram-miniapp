<body>
  <style>
    body {
      margin: 0;
      padding: 24px;
      font-family: system-ui, sans-serif;
      background-color: #1e1e1e;
      color: #eaeaea;
    }

    h1 {
      font-size: 22px;
      font-weight: 600;
      margin-bottom: 24px;
      text-align: center;
    }

    .button {
      display: block;
      width: 100%;
      max-width: 320px;
      margin: 10px auto;
      padding: 14px 16px;
      font-size: 16px;
      background-color: #2a2a2a;
      border: 1px solid #444;
      border-radius: 12px;
      text-align: center;
      color: #eaeaea;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .button:hover {
      background-color: #383838;
    }

    .hidden {
      display: none;
    }

    input[type="text"],
    input[type="datetime-local"] {
      padding: 10px;
      font-size: 16px;
      width: 100%;
      max-width: 300px;
      margin: 10px auto;
      display: block;
      border: 1px solid #555;
      border-radius: 8px;
      background-color: #2a2a2a;
      color: #eaeaea;
    }

    .card {
      background-color: #2a2a2a;
      border: 1px solid #444;
      border-radius: 10px;
      padding: 12px 16px;
      margin-bottom: 12px;
    }

    .card-title {
      font-weight: 600;
      margin-bottom: 4px;
    }

    .card-sub {
      font-size: 14px;
      color: #aaa;
      margin-bottom: 8px;
    }

    #caseSearch {
      width: 100%;
      max-width: 300px;
      padding: 10px;
      margin: 0 auto 16px;
      display: block;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #555;
      background-color: #2a2a2a;
      color: #eaeaea;
    }
  </style>

  <div id="menu">
    <h1>–ê—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫</h1>
    <div class="button" onclick="showMyCases()">üìÅ –ú–æ–∏ –¥–µ–ª–∞</div>
    <div class="button" onclick="showSearch()">üîç –ù–∞–π—Ç–∏ –ø—Ä–∞–∫—Ç–∏–∫—É</div>
    <div class="button" onclick="Telegram.WebApp.close()">‚ùå –ó–∞–∫—Ä—ã—Ç—å</div>
  </div>

  <div id="cases" class="hidden">
    <h1>–ú–æ–∏ –¥–µ–ª–∞</h1>
    <input type="text" id="caseSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –Ω–æ–º–µ—Ä—É" oninput="renderCaseList()" />
    <div id="caseList"></div>
    <div class="button" onclick="showCaseForm()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –¥–µ–ª–æ</div>
    <div class="button" onclick="showMenu()">üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</div>
  </div>

  <div id="caseForm" class="hidden">
    <h1>–ù–æ–≤–æ–µ –¥–µ–ª–æ</h1>
    <input type="text" id="caseName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–∏–∫–∞" />
    <input type="text" id="caseNumber" placeholder="–ù–æ–º–µ—Ä –¥–µ–ª–∞" />
    <div class="button" onclick="addCase()">‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</div>
    <div class="button" onclick="showMyCases()">üîô –ù–∞–∑–∞–¥</div>
  </div>

  <div id="hearings" class="hidden">
    <h1>–ó–∞—Å–µ–¥–∞–Ω–∏—è</h1>
    <div id="hearingList"></div>
    <input type="datetime-local" id="hearingDate" />
    <input type="text" id="hearingComment" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" />
    <div class="button" onclick="addHearing()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞—Å–µ–¥–∞–Ω–∏–µ</div>
    <div class="button" onclick="showMyCases()">üîô –ù–∞–∑–∞–¥ –∫ –¥–µ–ª–∞–º</div>
  </div>

  <div id="search" class="hidden">
    <h1>–ü–æ–∏—Å–∫ –ø–æ –ò–ù–ù/–û–ì–†–ù</h1>
    <input type="text" id="searchInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ò–ù–ù –∏–ª–∏ –û–ì–†–ù" />
    <div class="button" onclick="searchKad()">–ù–∞–π—Ç–∏</div>
    <div class="button" onclick="showMenu()">üîô –ù–∞–∑–∞–¥</div>
  </div>

  <script>
    let currentCaseIndex = null;

    function hideAll() {
      ["menu", "cases", "caseForm", "hearings", "search"].forEach(id => {
        document.getElementById(id).classList.add("hidden");
      });
    }

    function showMenu() {
      hideAll();
      document.getElementById("menu").classList.remove("hidden");
    }

    function showMyCases() {
      hideAll();
      document.getElementById("cases").classList.remove("hidden");
      renderCaseList();
    }

    function showCaseForm() {
      hideAll();
      document.getElementById("caseForm").classList.remove("hidden");
    }

    function showSearch() {
      hideAll();
      document.getElementById("search").classList.remove("hidden");
    }

    function showHearings(index) {
      hideAll();
      currentCaseIndex = index;
      document.getElementById("hearings").classList.remove("hidden");
      renderHearings();
    }

    function addCase() {
      const name = document.getElementById("caseName").value.trim();
      const number = document.getElementById("caseNumber").value.trim();
      if (!name || !number) return alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±–∞ –ø–æ–ª—è");
      const cases = JSON.parse(localStorage.getItem("myCases") || "[]");
      cases.push({ name, number, hearings: [] });
      localStorage.setItem("myCases", JSON.stringify(cases));
      showMyCases();
    }

    function renderCaseList() {
      const search = document.getElementById("caseSearch").value.toLowerCase();
      const cases = JSON.parse(localStorage.getItem("myCases") || "[]");
      const container = document.getElementById("caseList");
      container.innerHTML = "";

      cases.forEach((c, i) => {
        if (
          !c.name.toLowerCase().includes(search) &&
          !c.number.toLowerCase().includes(search)
        ) return;
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `
          <div class="card-title">üìÅ ${c.name}</div>
          <div class="card-sub">‚Ññ ${c.number}</div>
          <div class="button" onclick="showHearings(${i})">üìÖ –ó–∞—Å–µ–¥–∞–Ω–∏—è</div>
          <div class="button" onclick="alert('–ó–∞–¥–∞—á–∏ —Å–∫–æ—Ä–æ –±—É–¥—É—Ç')">üìå –ó–∞–¥–∞—á–∏</div>
        `;
        container.appendChild(div);
      });
    }

    function renderHearings() {
      const cases = JSON.parse(localStorage.getItem("myCases") || "[]");
      const hearings = cases[currentCaseIndex].hearings || [];
      const list = document.getElementById("hearingList");
      list.innerHTML = hearings.length ? "" : "<p style='text-align:center;'>–ù–µ—Ç –∑–∞—Å–µ–¥–∞–Ω–∏–π</p>";
      hearings.forEach(h => {
        const p = document.createElement("p");
        p.textContent = `${new Date(h.date).toLocaleString()} ‚Äî ${h.comment || "–±–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è"}`;
        list.appendChild(p);
      });
    }

    function addHearing() {
      const date = document.getElementById("hearingDate").value;
      const comment = document.getElementById("hearingComment").value.trim();
      if (!date) return alert("–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∑–∞—Å–µ–¥–∞–Ω–∏—è");
      const cases = JSON.parse(localStorage.getItem("myCases") || "[]");
      cases[currentCaseIndex].hearings.push({ date, comment });
      localStorage.setItem("myCases", JSON.stringify(cases));
      document.getElementById("hearingDate").value = "";
      document.getElementById("hearingComment").value = "";
      renderHearings();
    }

    function searchKad() {
      const val = document.getElementById("searchInput").value.trim();
      if (!val) return alert("–í–≤–µ–¥–∏—Ç–µ –ò–ù–ù –∏–ª–∏ –û–ì–†–ù");
      window.open(`https://kad.arbitr.ru/Search/quick?Query=${encodeURIComponent(val)}`, "_blank");
    }

    if (window.Telegram) Telegram.WebApp.ready();
  </script>
</body>
